#!/usr/bin/env python3

import pwn
import scapy.all

pcap = pwn.args.PCAP or ("ping.pcapng")


def main(target):
    pcap = scapy.all.rdpcap(target)
    answer = ""

    pwn.info(f"PCAPâ€¯contains {str(pcap)!s}")

    for i in range(len(pcap)):
        if i % 2 == 0:
            if pcap[i].haslayer(scapy.all.ICMP):
                answer += str(chr(int(len(pcap[i]) - 42)))
    if answer:
        pwn.success(f"flag is : {answer!s}")


if __name__ == "__main__":

    main(pcap)
